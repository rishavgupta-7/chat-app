{"ast":null,"code":"var _jsxFileName = \"D:\\\\MERN\\\\projects\\\\Social-media\\\\frontend\\\\src\\\\pages\\\\Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { io } from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Chat = ({\n  user\n}) => {\n  _s();\n  const [socket, setSocket] = useState(null);\n  const [message, setMessage] = useState(\"\");\n  const [receiverPhone, setReceiverPhone] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  useEffect(() => {\n    if (!user || !user.id) return;\n    const newSocket = io(\"http://localhost:5000\", {\n      query: {\n        userId: user.id\n      } // ✅ user.id from backend\n    });\n    setSocket(newSocket);\n    newSocket.on(\"receiveMessage\", msg => {\n      setMessages(prev => [...prev, msg]);\n    });\n    return () => newSocket.disconnect();\n  }, [user]);\n  const sendMessage = () => {\n    if (!message || !receiverPhone) return;\n    socket.emit(\"sendMessage\", {\n      senderId: user.id,\n      // ✅ Always send senderId\n      receiverPhone,\n      text: message\n    });\n    setMessages(prev => [...prev, {\n      senderId: user.id,\n      text: message\n    }]);\n    setMessage(\"\");\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      placeholder: \"Receiver Phone\",\n      value: receiverPhone,\n      onChange: e => setReceiverPhone(e.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      placeholder: \"Message\",\n      value: message,\n      onChange: e => setMessage(e.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: sendMessage,\n      children: \"Send\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Messages:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 9\n      }, this), messages.map((msg, i) => /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [msg.senderId === user.id ? \"You\" : \"Friend\", \": \", msg.text]\n      }, i, true, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 40,\n    columnNumber: 5\n  }, this);\n};\n_s(Chat, \"6zjx0wNSgA67QBdnSTgajkb1g9w=\");\n_c = Chat;\nexport default Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","io","jsxDEV","_jsxDEV","Chat","user","_s","socket","setSocket","message","setMessage","receiverPhone","setReceiverPhone","messages","setMessages","id","newSocket","query","userId","on","msg","prev","disconnect","sendMessage","emit","senderId","text","children","placeholder","value","onChange","e","target","fileName","_jsxFileName","lineNumber","columnNumber","onClick","map","i","_c","$RefreshReg$"],"sources":["D:/MERN/projects/Social-media/frontend/src/pages/Chat.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { io } from \"socket.io-client\";\r\n\r\nconst Chat = ({ user }) => {\r\n  const [socket, setSocket] = useState(null);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [receiverPhone, setReceiverPhone] = useState(\"\");\r\n  const [messages, setMessages] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (!user || !user.id) return;\r\n\r\n    const newSocket = io(\"http://localhost:5000\", {\r\n      query: { userId: user.id }, // ✅ user.id from backend\r\n    });\r\n\r\n    setSocket(newSocket);\r\n\r\n    newSocket.on(\"receiveMessage\", (msg) => {\r\n      setMessages((prev) => [...prev, msg]);\r\n    });\r\n\r\n    return () => newSocket.disconnect();\r\n  }, [user]);\r\n\r\n  const sendMessage = () => {\r\n    if (!message || !receiverPhone) return;\r\n\r\n    socket.emit(\"sendMessage\", {\r\n      senderId: user.id,      // ✅ Always send senderId\r\n      receiverPhone,\r\n      text: message,\r\n    });\r\n\r\n    setMessages((prev) => [...prev, { senderId: user.id, text: message }]);\r\n    setMessage(\"\");\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <input\r\n        placeholder=\"Receiver Phone\"\r\n        value={receiverPhone}\r\n        onChange={(e) => setReceiverPhone(e.target.value)}\r\n      />\r\n      <input\r\n        placeholder=\"Message\"\r\n        value={message}\r\n        onChange={(e) => setMessage(e.target.value)}\r\n      />\r\n      <button onClick={sendMessage}>Send</button>\r\n\r\n      <div>\r\n        <h4>Messages:</h4>\r\n        {messages.map((msg, i) => (\r\n          <p key={i}>\r\n            {msg.senderId === user.id ? \"You\" : \"Friend\"}: {msg.text}\r\n          </p>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}