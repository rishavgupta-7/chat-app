{"ast":null,"code":"var _jsxFileName = \"D:\\\\MERN\\\\projects\\\\Social-media\\\\frontend\\\\src\\\\pages\\\\Chat.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { io } from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Chat({\n  user\n}) {\n  _s();\n  const [socket, setSocket] = useState(null);\n  const [text, setText] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  useEffect(() => {\n    if (!(user !== null && user !== void 0 && user._id)) return;\n\n    // âœ… create socket connection\n    const newSocket = io(\"http://localhost:5000\", {\n      transports: [\"websocket\"],\n      query: {\n        userId: user._id\n      }\n    });\n\n    // âœ… when connected\n    newSocket.on(\"connect\", () => {\n      console.log(\"âœ… Connected to socket.io:\", newSocket.id);\n      setSocket(newSocket);\n    });\n\n    // âœ… when receiving message\n    newSocket.on(\"receiveMessage\", msg => {\n      console.log(\"ðŸ“© Message received:\", msg);\n      setMessages(prev => [...prev, msg]);\n    });\n\n    // âœ… handle disconnect\n    newSocket.on(\"disconnect\", () => {\n      console.log(\"âŒ Socket disconnected\");\n      setSocket(null);\n    });\n\n    // âœ… cleanup on unmount\n    return () => newSocket.disconnect();\n  }, [user]);\n\n  // âœ… send message\n  const sendMessage = () => {\n    if (!socket) {\n      console.warn(\"âš ï¸ Socket not connected yet!\");\n      return;\n    }\n    if (!text) return;\n    socket.emit(\"sendMessage\", {\n      senderId: user._id,\n      receiverPhone: \"9876543210\",\n      // change to target phone number\n      text\n    });\n    setMessages(prev => [...prev, {\n      senderId: user._id,\n      text\n    }]);\n    setText(\"\");\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Chat\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: messages.map((m, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"b\", {\n          children: [m.senderId === user._id ? \"You\" : \"Friend\", \":\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 13\n        }, this), \" \", m.text]\n      }, i, true, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      value: text,\n      onChange: e => setText(e.target.value),\n      placeholder: \"Type message...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: sendMessage,\n      disabled: !socket,\n      children: socket ? \"Send\" : \"Connecting...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"sx4xSo8jBlq3GzZVQL1S6q9s3vw=\");\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["useEffect","useState","io","jsxDEV","_jsxDEV","Chat","user","_s","socket","setSocket","text","setText","messages","setMessages","_id","newSocket","transports","query","userId","on","console","log","id","msg","prev","disconnect","sendMessage","warn","emit","senderId","receiverPhone","children","fileName","_jsxFileName","lineNumber","columnNumber","map","m","i","value","onChange","e","target","placeholder","onClick","disabled","_c","$RefreshReg$"],"sources":["D:/MERN/projects/Social-media/frontend/src/pages/Chat.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { io } from \"socket.io-client\";\r\n\r\nexport default function Chat({ user }) {\r\n  const [socket, setSocket] = useState(null);\r\n  const [text, setText] = useState(\"\");\r\n  const [messages, setMessages] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (!user?._id) return;\r\n\r\n    // âœ… create socket connection\r\n    const newSocket = io(\"http://localhost:5000\", {\r\n      transports: [\"websocket\"],\r\n      query: { userId: user._id },\r\n    });\r\n\r\n    // âœ… when connected\r\n    newSocket.on(\"connect\", () => {\r\n      console.log(\"âœ… Connected to socket.io:\", newSocket.id);\r\n      setSocket(newSocket);\r\n    });\r\n\r\n    // âœ… when receiving message\r\n    newSocket.on(\"receiveMessage\", (msg) => {\r\n      console.log(\"ðŸ“© Message received:\", msg);\r\n      setMessages((prev) => [...prev, msg]);\r\n    });\r\n\r\n    // âœ… handle disconnect\r\n    newSocket.on(\"disconnect\", () => {\r\n      console.log(\"âŒ Socket disconnected\");\r\n      setSocket(null);\r\n    });\r\n\r\n    // âœ… cleanup on unmount\r\n    return () => newSocket.disconnect();\r\n  }, [user]);\r\n\r\n  // âœ… send message\r\n  const sendMessage = () => {\r\n    if (!socket) {\r\n      console.warn(\"âš ï¸ Socket not connected yet!\");\r\n      return;\r\n    }\r\n\r\n    if (!text) return;\r\n    socket.emit(\"sendMessage\", {\r\n      senderId: user._id,\r\n      receiverPhone: \"9876543210\", // change to target phone number\r\n      text,\r\n    });\r\n    setMessages((prev) => [...prev, { senderId: user._id, text }]);\r\n    setText(\"\");\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h3>Chat</h3>\r\n      <div>\r\n        {messages.map((m, i) => (\r\n          <div key={i}>\r\n            <b>{m.senderId === user._id ? \"You\" : \"Friend\"}:</b> {m.text}\r\n          </div>\r\n        ))}\r\n      </div>\r\n      <input\r\n        value={text}\r\n        onChange={(e) => setText(e.target.value)}\r\n        placeholder=\"Type message...\"\r\n      />\r\n      <button onClick={sendMessage} disabled={!socket}>\r\n        {socket ? \"Send\" : \"Connecting...\"}\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}